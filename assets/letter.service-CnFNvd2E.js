var b=Object.defineProperty;var T=(t,e,s)=>e in t?b(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var r=(t,e,s)=>T(t,typeof e!="symbol"?e+"":e,s);import{s as g,h as K,T as R}from"./index-Ba0rJTqi.js";var L=Object.getOwnPropertyDescriptor,O=(t,e,s,o)=>{for(var i=o>1?void 0:o?L(e,s):e,n=t.length-1,a;n>=0;n--)(a=t[n])&&(i=a(i)||i);return i};let f=class{constructor(){r(this,"STORAGE_KEY_LETTERS","bawaslu_letters");r(this,"STORAGE_KEY_CLASSES","bawaslu_classifications");r(this,"letters",g(this.loadLetters()));r(this,"classifications",g(this.loadClassifications()));r(this,"stats",K(()=>{const t=this.letters(),e=t.length,s=t.filter(a=>a.signatory==="Alnofrizal").length,o=t.filter(a=>a.signatory==="Asmin safari Lubis").length,i={},n={};return t.forEach(a=>{const c=new Date(a.date),l=`${c.getFullYear()}-${(c.getMonth()+1).toString().padStart(2,"0")}`;i[l]=(i[l]||0)+1,n[a.classificationCode]=(n[a.classificationCode]||0)+1}),{total:e,ttdKetua:s,ttdKasek:o,byMonth:i,byCode:n}}))}loadLetters(){const t=localStorage.getItem(this.STORAGE_KEY_LETTERS);return t?JSON.parse(t):[]}loadClassifications(){const t=localStorage.getItem(this.STORAGE_KEY_CLASSES);return t?JSON.parse(t):[{id:"1",code:"PM",name:"Pengawasan Pemilu",subCodes:["00.00","01.00","02.00"]},{id:"2",code:"PP",name:"PENANGANAN PELANGGARAN DAN SENGKETA PEMILU",subCodes:["00.01"]},{id:"3",code:"PS",name:"PENYELESAIAN SENGKETA",subCodes:[]},{id:"4",code:"PR",name:"PERENCANAAN",subCodes:[]},{id:"5",code:"OT",name:"ORGANISASI DAN TATA LAKSANA",subCodes:[]},{id:"6",code:"KA",name:"PERSURATAN DAN KEARSIPAN",subCodes:[]},{id:"7",code:"KU",name:"KEUANGAN",subCodes:[]},{id:"8",code:"PL",name:"PERLENGKAPAN",subCodes:[]},{id:"9",code:"HK",name:"HUKUM",subCodes:[]},{id:"10",code:"HM",name:"HUBUNGAN MASYARAKAT",subCodes:[]},{id:"11",code:"KP",name:"KEPEGAWAIAN",subCodes:[]},{id:"12",code:"RT",name:"KETATAUSAHAAN DAN KERUMAHTANGGAAN",subCodes:[]},{id:"13",code:"TI",name:"TEKNOLOGI INFORMASI",subCodes:[]}]}saveLetter(t){const e=this.letters(),s=new Date(t.date),o=(s.getMonth()+1).toString(),i=s.getFullYear().toString(),a=["","I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"][parseInt(o)],c=e.filter(d=>d.classificationCode===t.classificationCode&&new Date(d.date).getFullYear()===s.getFullYear()),l=c.length>0?Math.max(...c.map(d=>d.sequence)):0;let A=l+1,S="";const E=c.filter(d=>d.date===t.date);E.length>0?(A=E[0].sequence,S=`.${E.length+1}`):c.filter(h=>new Date(h.date)>s).length>0&&(A=l+1);const m=t.signatory==="Alnofrizal"?"K.RA":"RA",I=t.subCode?`.${t.subCode}`:"",C=`${A}${S}/${t.classificationCode}${I}/${m}/${a}/${i}`,u={...t,id:Date.now().toString(),letterNumber:C,sequence:A,suffix:S,createdAt:Date.now()},N=[u,...e];return this.letters.set(N),localStorage.setItem(this.STORAGE_KEY_LETTERS,JSON.stringify(N)),u}deleteLetter(t){const e=this.letters().filter(s=>s.id!==t);this.letters.set(e),localStorage.setItem(this.STORAGE_KEY_LETTERS,JSON.stringify(e))}addClassification(t,e){const s=[...this.classifications(),{id:Date.now().toString(),code:t,name:e,subCodes:[]}];this.classifications.set(s),localStorage.setItem(this.STORAGE_KEY_CLASSES,JSON.stringify(s))}addSubCode(t,e){const s=this.classifications().map(o=>o.id===t?{...o,subCodes:[...o.subCodes,e]}:o);this.classifications.set(s),localStorage.setItem(this.STORAGE_KEY_CLASSES,JSON.stringify(s))}};f=O([R({providedIn:"root"})],f);export{f as L};
